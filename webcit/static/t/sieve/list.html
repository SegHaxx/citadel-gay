<?=("head")><?%("COND:LOGGEDIN", 1, 1, 1, "", ="paging")>

<div id="banner">
	<img src="static/webcit_icons/essen/32x32/config.png">
	<h1><?_("View/edit server-side mail filters")></h1>
</div>

<div id="content" class="service">

  <table class="sieve_background">
    <tr><td valign="top"><form id="sieveform" method="post" action="save_sieve">
	<input type="hidden" name="nonce" value="<?NONCE>">

	<?_("When new mail arrives: ")><br>
 	<?_("Filter it according to rules selected below")>

	<!-- This is a hack to force everyone to use the "rules" version since we are abandoning Sieve.   -- ajc 2020jul11
	<select name="bigaction" size=1 onChange="ToggleSievePanels();">
 	  <option <?%("COND:BSTR", 1, "__SIEVE:RULESSCRIPT", 1, "", "selected")> value="0"><?_("Leave it in my inbox without filtering")></option>
 	  <option <?%("COND:BSTR", 1, "__SIEVE:RULESSCRIPT", 1, "selected", "")> value="1"><?_("Filter it according to rules selected below")></option>
 	  <option <?%("COND:BSTR", 1, "__SIEVE:EXTERNAL_SCRIPT", 1, "selected", "")> value="2"><?_("Filter it through a manually edited script (advanced users only)")></option>
	</select>
	-->

	<div id="sievediv1">
		<?=("sieve_display")><br>
		<table cellpadding="2" width="100%" class="altern">
			<?ITERATE("SIEVE:RULES", ="sieve_display_one")>
		</table>
		<br>
		<div id="div_addrule"><a href="javascript:AddRule();"><?_("Add rule")></a><br></div>
		<script type="text/javascript">UpdateRules();</script>
	</div>

	<div align="center"><br>
		<input type="submit" name="save_button" value='<?_("Save changes")>'>
		&nbsp;
		<input type="submit" name="cancel_button" value='<?_("Cancel")>'>
	</div>
  </form></td></tr></table>

  <script type="text/javascript">ToggleSievePanels();</script>

</div> <!-- end of 'content' div -->
<?=("trailing")>
